# MIP 001: Mises Naming System

## Changelog

- 2021-12-15: init

## Status

Not Implemented

> 

## Abstract

This MIP introduces a mechanism to map the crypto address in Mises network to  human readable format and vise versa.


## Context

In Crypto World, things are identified by their crypto addresses, and an address is generated by a public key which is typically a 32 bit length hex string.  Crypto address is hard to remember, and thus it‘s useless in brand communication(personal or business brand)， which is an very essetial in a social media.
There was a successful naming system in ethereum - ENS, but it costs too much because it runs on ethereum contract. ENS is also NFT based, so any domain in ENS is tradable just like DNS system.
So in Mises Network，a cheaper and more effective naming system is needed to solve this problem, we call it MNS - Mises Naming System. 

There are several design consideration In MNS: 

- Usage

As username of Mises Discover;

Mapping to Wallet Addresses of different blockchain;

Mapping to resources stored on Mises Decentralized Storage

As part of Name of resources stored on Mises Decentralized Storage

- Child Name

If sb owns a Name of MNS, all sub Names also belong to him;

For example, there is a Name called “Mises”, all “Mises.x” are sub names of “Mises”

Mises.eth should be Mises’s Ethereum wallet address;

Mises.mis should be Mises’s Mises wallet address;

Mises.midway could be a uri of a movie stored on Mises Decentralized Storage, it can be accessed by browsers(mises browser or other browers) via “mises.midway.res”

.eth, .mis, .res are reserved child suffix, they have special meaning and interpreted by mises chain, those suffixes could be added by later request of comments. 

- Service Fee

There will be a 5$ service fee per year for each MNS Name.

- Trading

An user can transfer his MNS Name to another user.

When a Name transferred, all its sub names belongs to new owner. New owner can set new mappings for Name and its sub name, he can also create any new sub names.

- Market

An opensea.io like market for trading MNS Names.

## Decision

There is a  [NFT Module][1]  in Cosmos SDK, it helps anyone to deveploer nft based feature， so we SHOULD build the MNS on it.

Here is the definition of NFT Class and NFT in Cosmos SDK:

```
// Class defines the class of the nft type.
message Class {
  // id defines the unique identifier of the NFT classification, similar to the contract address of ERC721
  string id = 1;

  // name defines the human-readable name of the NFT classification. Optional
  string name = 2;

  // symbol is an abbreviated name for nft classification. Optional
  string symbol = 3;

  // description is a brief description of nft classification. Optional
  string description = 4;

  // uri for the class metadata stored off chain. It can define schema for Class and NFT `Data` attributes. Optional
  string uri = 5;

  // uri_hash is a hash of the document pointed by uri. Optional
  string uri_hash = 6;

  // data is the app specific metadata of the NFT class. Optional
  google.protobuf.Any data = 7;
}

// NFT defines the NFT.
message NFT {
  // class_id associated with the NFT, similar to the contract address of ERC721
  string class_id = 1;

  // id is a unique identifier of the NFT
  string id = 2;

  // uri for the NFT metadata stored off chain
  string uri = 3;

  // uri_hash is a hash of the document pointed by uri
  string uri_hash = 4;

  // data is an app specific data of the NFT. Optional
  google.protobuf.Any data = 10;
}

```

We use a new class of NFT called NamingNFT to record the naming registry.

First we introduce some definitions in  MNS system:

- the MNS module account, owns a MIS token pool that operate the whole system
- The MNS Admin, who build the MSN system. Who can withdraw MIS from the MNS module account
- The owner of the NamingNFT, who mint/create a NamingNFT, and send MIS the MNS module account to activate the NamingNFT a period, and  change the naming resolution entries of a NamingNFT.
- The resolver, who read the NamingNFT  to resolve a name.



Some NamingNFT class related info MUST included in the class.data field , including:

- The prices rules: to calculate the prices of a given name.
- The reserved suffix rules : regexp rules of reserved suffix  that a resolution entry can accept. For example: name.eth MUST map to an eth address,  name.mis MUST map to an miss address, name.home MUST map to an URL .

The NamingNFT nft class will be created using a msg in genesis.json. And the class owner will be the MNS admin. Only MNS admin can modify the NamingNFT class.



 A MNS entry is represented by a nft, and we SHOULD using the nft.id to identify the domain name.

And some NamingNFT  related info MUST included in the nft.data field , including:

- The Naming registry, including many name/subname ->  address/url mapping.This field can only be modified by the current owner of this NamingNFT.
- The Minter/Operator address who mint this NFT.This field is readonly.
- The TTL(represented by a block height) of the nft, any MNS resolve should stop resolve this entry after this block. This field can only be modified by the minter by send MIS to the MNS module account.



We  need some new Msgs type to create and modify    Naming NFT class by the MNS admin:

```protobuf
message SuffixRule {
  string suffix;
  string address_regex_rule;
}
message PriceRule {
  Coin price;
  string name_regex_rule;
  string suffix_regex_rule;
  uint64 ttl;
  uint64 max_subname_count;
}

message MsgCreateNamingNFTClass {
  string naming_nft_class_id;
  repeat SuffixRule reserved_suffix;
  repeat PriceRule prices;
}
message MsgEditMNSRules {
  repeat SuffixRule reserved_suffix;
  repeat PriceRule prices;
}
```



We also need some new Msgs type to mint and modify  a NFT will be owned by an account as follows:

```protobuf
message MsgMintNamingNFT {
  string naming_nft_id;
  PriceRule price;
}
message NamingEntry {
  string suffix;
  string target_address
}
message MsgEditNamingNFTResolution {
	string naming_nft_id；
  repeat NamingEntry entries;
}
message MsgRenewNamingNFT{
	string naming_nft_id；
  PriceRule price;
}
```



## Consequences

- a market place website is needed to buy and exchange Mises domians.

- Mises wallet MUST support read all NamingNft owned by wallet user.

- Mises apps like mises discover  MUST resolve these name when nessesary.

  

### Backwards Compatibility

Not related

### Positive

- compatible with the cosmos NFT design, and thus suitable for ibc/gravity transfer in the future
- Simple and enough for basic usage.
- Upgradable by changing name and address regex rules.
- the name regex rule can be uses to limit the name length, or special chars.

### Negative

- user may confused it with ENS
- when and how the admin account use the MNS token pool is not defined
- No reverse naming resolution is native supported 

### Neutral

{neutral consequences}

## Further Discussions

The NamingNFT currently MUST be mint with a special Account called MNS admin, which was set by hand in genesis.json.
We may also allow more partner accounts to be able to do the same job later.

## Test Cases [optional]

- MNS admin  add new rules to the  MNS system
- Mises user buy mises name for a given period
- Edit sub name mapings
- Map and resolve name.eth to an eth address
- Map and resolve name.mis to a mises address
- Use name as recipient when transfering mises coin
- Use name as an username in mises discover 
- The expiration of mises name
- Mises user transfer Mises Name to other mises user

## References

[1]: <https://github.com/cosmos/cosmos-sdk/blob/master/docs/architecture/adr-043-nft-module.md> "The NFT design of Cosmos"
